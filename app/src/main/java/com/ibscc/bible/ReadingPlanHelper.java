package com.ibscc.bible;

import android.content.Context;
import android.content.SharedPreferences;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.List;

public class ReadingPlanHelper {

    private Context context;
    private SharedPreferences prefs;

    // Array completo com 365 dias de leitura
    public static final String[][] PLANO_365_DIAS = {
        // JANEIRO (31 dias)
        {"gn", "1-3", "mt", "1"}, {"gn", "4-6", "mt", "2"}, {"gn", "7-9", "mt", "3"},
        {"gn", "10-12", "mt", "4"}, {"gn", "13-15", "mt", "5"}, {"gn", "16-18", "mt", "6"},
        {"gn", "19-21", "mt", "7"}, {"gn", "22-24", "mt", "8"}, {"gn", "25-27", "mt", "9"},
        {"gn", "28-30", "mt", "10"}, {"gn", "31-33", "mt", "11"}, {"gn", "34-36", "mt", "12"},
        {"gn", "37-39", "mt", "13"}, {"gn", "40-42", "mt", "14"}, {"gn", "43-45", "mt", "15"},
        {"gn", "46-48", "mt", "16"}, {"gn", "49-50", "mt", "17"}, {"ex", "1-3", "mt", "18"},
        {"ex", "4-6", "mt", "19"}, {"ex", "7-9", "mt", "20"}, {"ex", "10-12", "mt", "21"},
        {"ex", "13-15", "mt", "22"}, {"ex", "16-18", "mt", "23"}, {"ex", "19-21", "mt", "24"},
        {"ex", "22-24", "mt", "25"}, {"ex", "25-27", "mt", "26"}, {"ex", "28-30", "mt", "27"},
        {"ex", "31-33", "mc", "1"}, {"ex", "34-36", "mc", "2"}, {"ex", "37-40", "mc", "3"},
        
        // FEVEREIRO (28 dias)
        {"lv", "1-3", "mc", "4"}, {"lv", "4-6", "mc", "5"}, {"lv", "7-9", "mc", "6"},
        {"lv", "10-12", "mc", "7"}, {"lv", "13-15", "mc", "8"}, {"lv", "16-18", "mc", "9"},
        {"lv", "19-21", "mc", "10"}, {"lv", "22-24", "mc", "11"}, {"lv", "25-27", "mc", "12"},
        {"nm", "1-3", "mc", "13"}, {"nm", "4-6", "mc", "14"}, {"nm", "7-9", "mc", "15"},
        {"nm", "10-12", "mc", "16"}, {"nm", "13-15", "lc", "1"}, {"nm", "16-18", "lc", "2"},
        {"nm", "19-21", "lc", "3"}, {"nm", "22-24", "lc", "4"}, {"nm", "25-27", "lc", "5"},
        {"nm", "28-30", "lc", "6"}, {"nm", "31-33", "lc", "7"}, {"nm", "34-36", "lc", "8"},
        {"dt", "1-3", "lc", "9"}, {"dt", "4-6", "lc", "10"}, {"dt", "7-9", "lc", "11"},
        {"dt", "10-12", "lc", "12"}, {"dt", "13-15", "lc", "13"}, {"dt", "16-18", "lc", "14"},
        {"dt", "19-21", "lc", "15"}, {"dt", "22-24", "lc", "16"},
        
        // MARÃ‡O (31 dias)
        {"dt", "25-27", "lc", "17"}, {"dt", "28-30", "lc", "18"}, {"dt", "31-34", "lc", "19"},
        {"js", "1-3", "lc", "20"}, {"js", "4-6", "lc", "21"}, {"js", "7-9", "lc", "22"},
        {"js", "10-12", "lc", "23"}, {"js", "13-15", "lc", "24"}, {"js", "16-18", "jo", "1"},
        {"js", "19-21", "jo", "2"}, {"js", "22-24", "jo", "3"}, {"jz", "1-3", "jo", "4"},
        {"jz", "4-6", "jo", "5"}, {"jz", "7-9", "jo", "6"}, {"jz", "10-12", "jo", "7"},
        {"jz", "13-15", "jo", "8"}, {"jz", "16-18", "jo", "9"}, {"jz", "19-21", "jo", "10"},
        {"rt", "1-4", "jo", "11"}, {"1sm", "1-3", "jo", "12"}, {"1sm", "4-6", "jo", "13"},
        {"1sm", "7-9", "jo", "14"}, {"1sm", "10-12", "jo", "15"}, {"1sm", "13-15", "jo", "16"},
        {"1sm", "16-18", "jo", "17"}, {"1sm", "19-21", "jo", "18"}, {"1sm", "22-24", "jo", "19"},
        {"1sm", "25-27", "jo", "20"}, {"1sm", "28-31", "jo", "21"}, {"2sm", "1-3", "at", "1"},
        
        // ABRIL (30 dias)
        {"2sm", "4-6", "at", "2"}, {"2sm", "7-9", "at", "3"}, {"2sm", "10-12", "at", "4"},
        {"2sm", "13-15", "at", "5"}, {"2sm", "16-18", "at", "6"}, {"2sm", "19-21", "at", "7"},
        {"2sm", "22-24", "at", "8"}, {"1rs", "1-3", "at", "9"}, {"1rs", "4-6", "at", "10"},
        {"1rs", "7-9", "at", "11"}, {"1rs", "10-12", "at", "12"}, {"1rs", "13-15", "at", "13"},
        {"1rs", "16-18", "at", "14"}, {"1rs", "19-22", "at", "15"}, {"2rs", "1-3", "at", "16"},
        {"2rs", "4-6", "at", "17"}, {"2rs", "7-9", "at", "18"}, {"2rs", "10-12", "at", "19"},
        {"2rs", "13-15", "at", "20"}, {"2rs", "16-18", "at", "21"}, {"2rs", "19-21", "at", "22"},
        {"2rs", "22-25", "at", "23"}, {"1cr", "1-3", "at", "24"}, {"1cr", "4-6", "at", "25"},
        {"1cr", "7-9", "at", "26"}, {"1cr", "10-12", "at", "27"}, {"1cr", "13-15", "at", "28"},
        {"1cr", "16-18", "rm", "1"}, {"1cr", "19-21", "rm", "2"}, {"1cr", "22-24", "rm", "3"},
        {"1cr", "25-27", "rm", "4"}, {"1cr", "28-29", "rm", "5"},
        
        // MAIO (31 dias)
        {"2cr", "1-3", "rm", "6"}, {"2cr", "4-6", "rm", "7"}, {"2cr", "7-9", "rm", "8"},
        {"2cr", "10-12", "rm", "9"}, {"2cr", "13-15", "rm", "10"}, {"2cr", "16-18", "rm", "11"},
        {"2cr", "19-21", "rm", "12"}, {"2cr", "22-24", "rm", "13"}, {"2cr", "25-27", "rm", "14"},
        {"2cr", "28-30", "rm", "15"}, {"2cr", "31-33", "rm", "16"}, {"2cr", "34-36", "1co", "1"},
        {"ed", "1-4", "1co", "2"}, {"ed", "5-7", "1co", "3"}, {"ed", "8-10", "1co", "4"},
        {"ne", "1-3", "1co", "5"}, {"ne", "4-6", "1co", "6"}, {"ne", "7-9", "1co", "7"},
        {"ne", "10-13", "1co", "8"}, {"et", "1-5", "1co", "9"}, {"et", "6-10", "1co", "10"},
        {"job", "1-3", "1co", "11"}, {"job", "4-6", "1co", "12"}, {"job", "7-9", "1co", "13"},
        {"job", "10-12", "1co", "14"}, {"job", "13-15", "1co", "15"}, {"job", "16-18", "1co", "16"},
        {"job", "19-21", "2co", "1"}, {"job", "22-24", "2co", "2"}, {"job", "25-27", "2co", "3"},
        {"job", "28-30", "2co", "4"}, {"job", "31-33", "2co", "5"},
        
        // JUNHO (30 dias)
        {"job", "34-36", "2co", "6"}, {"job", "37-39", "2co", "7"}, {"job", "40-42", "2co", "8"},
        {"sl", "1-3", "2co", "9"}, {"sl", "4-6", "2co", "10"}, {"sl", "7-9", "2co", "11"},
        {"sl", "10-12", "2co", "12"}, {"sl", "13-15", "2co", "13"}, {"sl", "16-18", "gl", "1"},
        {"sl", "19-21", "gl", "2"}, {"sl", "22-24", "gl", "3"}, {"sl", "25-27", "gl", "4"},
        {"sl", "28-30", "gl", "5"}, {"sl", "31-33", "gl", "6"}, {"sl", "34-36", "ef", "1"},
        {"sl", "37-39", "ef", "2"}, {"sl", "40-42", "ef", "3"}, {"sl", "43-45", "ef", "4"},
        {"sl", "46-48", "ef", "5"}, {"sl", "49-51", "ef", "6"}, {"sl", "52-54", "fp", "1"},
        {"sl", "55-57", "fp", "2"}, {"sl", "58-60", "fp", "3"}, {"sl", "61-63", "fp", "4"},
        {"sl", "64-66", "cl", "1"}, {"sl", "67-69", "cl", "2"}, {"sl", "70-72", "cl", "3"},
        {"sl", "73-75", "cl", "4"}, {"sl", "76-78", "1ts", "1"}, {"sl", "79-81", "1ts", "2"},
        
        // JULHO (31 dias)
        {"sl", "82-84", "1ts", "3"}, {"sl", "85-87", "1ts", "4"}, {"sl", "88-90", "1ts", "5"},
        {"sl", "91-93", "2ts", "1"}, {"sl", "94-96", "2ts", "2"}, {"sl", "97-99", "2ts", "3"},
        {"sl", "100-102", "1tm", "1"}, {"sl", "103-105", "1tm", "2"}, {"sl", "106-108", "1tm", "3"},
        {"sl", "109-111", "1tm", "4"}, {"sl", "112-114", "1tm", "5"}, {"sl", "115-117", "1tm", "6"},
        {"sl", "118", "2tm", "1"}, {"sl", "119-120", "2tm", "2"}, {"sl", "121-123", "2tm", "3"},
        {"sl", "124-126", "2tm", "4"}, {"sl", "127-129", "tt", "1"}, {"sl", "130-132", "tt", "2"},
        {"sl", "133-135", "tt", "3"}, {"sl", "136-138", "fm", "1"}, {"sl", "139-141", "hb", "1"},
        {"sl", "142-144", "hb", "2"}, {"sl", "145-147", "hb", "3"}, {"sl", "148-150", "hb", "4"},
        {"pv", "1-3", "hb", "5"}, {"pv", "4-6", "hb", "6"}, {"pv", "7-9", "hb", "7"},
        {"pv", "10-12", "hb", "8"}, {"pv", "13-15", "hb", "9"}, {"pv", "16-18", "hb", "10"},
        {"pv", "19-21", "hb", "11"}, {"pv", "22-24", "hb", "12"},
        
        // AGOSTO (31 dias)
        {"pv", "25-27", "hb", "13"}, {"pv", "28-31", "tg", "1"}, {"ec", "1-4", "tg", "2"},
        {"ec", "5-8", "tg", "3"}, {"ec", "9-12", "tg", "4"}, {"ct", "1-4", "tg", "5"},
        {"ct", "5-8", "1pe", "1"}, {"is", "1-3", "1pe", "2"}, {"is", "4-6", "1pe", "3"},
        {"is", "7-9", "1pe", "4"}, {"is", "10-12", "1pe", "5"}, {"is", "13-15", "2pe", "1"},
        {"is", "16-18", "2pe", "2"}, {"is", "19-21", "2pe", "3"}, {"is", "22-24", "1jo", "1"},
        {"is", "25-27", "1jo", "2"}, {"is", "28-30", "1jo", "3"}, {"is", "31-33", "1jo", "4"},
        {"is", "34-36", "1jo", "5"}, {"is", "37-39", "2jo", "1"}, {"is", "40-42", "3jo", "1"},
        {"is", "43-45", "jd", "1"}, {"is", "46-48", "ap", "1"}, {"is", "49-51", "ap", "2"},
        {"is", "52-54", "ap", "3"}, {"is", "55-57", "ap", "4"}, {"is", "58-60", "ap", "5"},
        {"is", "61-63", "ap", "6"}, {"is", "64-66", "ap", "7"}, {"jr", "1-3", "ap", "8"},
        {"jr", "4-6", "ap", "9"}, {"jr", "7-9", "ap", "10"},
        
        // SETEMBRO (30 dias)
        {"jr", "10-12", "ap", "11"}, {"jr", "13-15", "ap", "12"}, {"jr", "16-18", "ap", "13"},
        {"jr", "19-21", "ap", "14"}, {"jr", "22-24", "ap", "15"}, {"jr", "25-27", "ap", "16"},
        {"jr", "28-30", "ap", "17"}, {"jr", "31-33", "ap", "18"}, {"jr", "34-36", "ap", "19"},
        {"jr", "37-39", "ap", "20"}, {"jr", "40-42", "ap", "21"}, {"jr", "43-45", "ap", "22"},
        {"jr", "46-48", "lm", "1"}, {"jr", "49-52", "lm", "2"}, {"lm", "3-5", "lm", "3"},
        {"ez", "1-3", "lm", "4"}, {"ez", "4-6", "lm", "5"}, {"ez", "7-9", "lm", "6"},
        {"ez", "10-12", "lm", "7"}, {"ez", "13-15", "lm", "8"}, {"ez", "16-18", "lm", "9"},
        {"ez", "19-21", "lm", "10"}, {"ez", "22-24", "lm", "11"}, {"ez", "25-27", "lm", "12"},
        {"ez", "28-30", "lm", "13"}, {"ez", "31-33", "lm", "14"}, {"ez", "34-36", "lm", "15"},
        {"ez", "37-39", "lm", "16"}, {"ez", "40-42", "lm", "17"}, {"ez", "43-45", "lm", "18"},
        {"ez", "46-48", "lm", "19"},
        
        // OUTUBRO (31 dias)
        {"dn", "1-3", "lm", "20"}, {"dn", "4-6", "lm", "21"}, {"dn", "7-9", "lm", "22"},
        {"dn", "10-12", "os", "1"}, {"os", "1-3", "os", "2"}, {"os", "4-6", "os", "3"},
        {"os", "7-9", "os", "4"}, {"os", "10-12", "os", "5"}, {"os", "13-14", "os", "6"},
        {"jl", "1-3", "os", "7"}, {"am", "1-3", "os", "8"}, {"am", "4-6", "os", "9"},
        {"am", "7-9", "am", "1"}, {"ob", "1", "am", "2"}, {"jn", "1-4", "am", "3"},
        {"mq", "1-3", "am", "4"}, {"mq", "4-7", "am", "5"}, {"na", "1-3", "am", "6"},
        {"hc", "1-3", "am", "7"}, {"sf", "1-3", "am", "8"}, {"ag", "1-2", "am", "9"},
        {"zc", "1-3", "mq", "1"}, {"zc", "4-6", "mq", "2"}, {"zc", "7-9", "mq", "3"},
        {"zc", "10-12", "mq", "4"}, {"zc", "13-14", "mq", "5"}, {"ml", "1-4", "mq", "6"},
        {"ml", "5-6", "mq", "7"}, {"mt", "1-3", "mq", "8"}, {"mt", "4-6", "mq", "9"},
        {"mt", "7-9", "na", "1"}, {"mt", "10-12", "na", "2"}, {"mt", "13-15", "na", "3"},
        
        // NOVEMBRO (30 dias)
        {"mt", "16-18", "hc", "1"}, {"mt", "19-21", "hc", "2"}, {"mt", "22-24", "hc", "3"},
        {"mt", "25-28", "sf", "1"}, {"mc", "1-3", "sf", "2"}, {"mc", "4-6", "sf", "3"},
        {"mc", "7-9", "ag", "1"}, {"mc", "10-12", "ag", "2"}, {"mc", "13-16", "zc", "1"},
        {"lc", "1-3", "zc", "2"}, {"lc", "4-6", "zc", "3"}, {"lc", "7-9", "zc", "4"},
        {"lc", "10-12", "zc", "5"}, {"lc", "13-15", "zc", "6"}, {"lc", "16-18", "zc", "7"},
        {"lc", "19-21", "zc", "8"}, {"lc", "22-24", "zc", "9"}, {"jo", "1-3", "zc", "10"},
        {"jo", "4-6", "zc", "11"}, {"jo", "7-9", "zc", "12"}, {"jo", "10-12", "zc", "13"},
        {"jo", "13-15", "zc", "14"}, {"jo", "16-18", "ml", "1"}, {"jo", "19-21", "ml", "2"},
        {"at", "1-3", "ml", "3"}, {"at", "4-6", "ml", "4"}, {"at", "7-9", "ml", "5"},
        {"at", "10-12", "ml", "6"}, {"at", "13-15", "mt", "1"}, {"at", "16-18", "mt", "2"},
        
        // DEZEMBRO (31 dias)
        {"at", "19-21", "mt", "3"}, {"at", "22-24", "mt", "4"}, {"at", "25-28", "mt", "5"},
        {"rm", "1-3", "mt", "6"}, {"rm", "4-6", "mt", "7"}, {"rm", "7-9", "mt", "8"},
        {"rm", "10-12", "mt", "9"}, {"rm", "13-15", "mt", "10"}, {"rm", "16-18", "mt", "11"},
        {"rm", "19-21", "mt", "12"}, {"rm", "22-24", "mt", "13"}, {"rm", "25-27", "mt", "14"},
        {"rm", "28-30", "mt", "15"}, {"rm", "31-33", "mt", "16"}, {"rm", "34-36", "mc", "1"},
        {"rm", "37-39", "mc", "2"}, {"rm", "40-42", "mc", "3"}, {"rm", "43-45", "mc", "4"},
        {"rm", "46-48", "mc", "5"}, {"rm", "49-51", "mc", "6"}, {"rm", "52-54", "mc", "7"},
        {"rm", "55-57", "mc", "8"}, {"rm", "58-60", "mc", "9"}, {"rm", "61-63", "mc", "10"},
        {"rm", "64-66", "mc", "11"}, {"1co", "1-3", "mc", "12"}, {"1co", "4-6", "mc", "13"},
        {"1co", "7-9", "mc", "14"}, {"1co", "10-12", "mc", "15"}, {"1co", "13-15", "mc", "16"},
        {"1co", "16", "lc", "1"}, {"2co", "1-3", "lc", "2"}, {"2co", "4-6", "lc", "3"}
    };

    public ReadingPlanHelper(Context context) {
        this.context = context;
        this.prefs = context.getSharedPreferences("ReadingPlan", Context.MODE_PRIVATE);
    }

    public String[] getTodayReading() {
        Calendar cal = Calendar.getInstance();
        int dayOfYear = cal.get(Calendar.DAY_OF_YEAR) - 1;
        
        if (dayOfYear >= 0 && dayOfYear < PLANO_365_DIAS.length) {
            return PLANO_365_DIAS[dayOfYear];
        }
        return PLANO_365_DIAS[0];
    }

    public void markAsRead(int day) {
        prefs.edit().putBoolean("day_" + day, true).apply();
        prefs.edit().putLong("last_read_date", System.currentTimeMillis()).apply();
    }

    public boolean isDayRead(int day) {
        return prefs.getBoolean("day_" + day, false);
    }

    public int getProgress() {
        int count = 0;
        for (int i = 0; i < 365; i++) {
            if (isDayRead(i)) count++;
        }
        return count;
    }

    public void resetPlan() {
        prefs.edit().clear().apply();
    }
    
    public int getCurrentDay() {
        Calendar cal = Calendar.getInstance();
        return cal.get(Calendar.DAY_OF_YEAR) - 1;
    }
}